PLANAR GEOMETRY PROBLEM HELP
			    Fri Aug 31 17:34:44 EDT 2001

For some reason many young computer scientists think
that geometry problems are hard, and avoid them.  The
purpose of this short discussion to demonstrate that
geometry problems are easy after all.

We will restrict ourselves here to planar geometry.

Basics
------

Let
	p = (px,py) and q = (qx,qy)
	
be points in the plane.  The difference

	v = (vx,vy) = p - q = (px-qx,py-qy)
	
is the vector from p to q.  Its length is

	|v| = sqrt( vx**2 + vy** 2 )

The scalar product of two vectors

	u = (ux,uy) and v = (vx,vy)

is

	u.v = ux*vx + uy*vy

	    = |u| |v| cos(theta)

where theta is the angle between u and v.  The sign of
theta does not matter because cos(theta) = cos(-theta).
Note that

	|v| = sqrt (v.v)

Note that u.v = 0 iff u and v are orthogonal (at right
angles) to each other, i.e., if theta = + or - 90
degrees and cos(theta) = 0.

A `unit' vector v is a vector of length 1 ( |v| = 1 ).
If u and v are unit vectors at right angles to each
other, which is the same as saying that

	|u| = 1,  |v| = 1,  u.v = 0

then one can ask what the coordinates of a point p
would be in the coordinate system in which u is in
the positive direction of the x axis and v is in the
positive direction of the y axis.  The answer is

	(u.p, v.p)

Note that

	| u.p |   | ux  uy | | px |
	|     | = |        | |    |
	| v.p |   | vx  vy | | py |

so u and v are the rows of the 2x2 matrix which by left
multiplication translates from old xy coordinates to new
uv axis coordinates.

If u is a unit vector, we call (u.v)u the projection of
v onto u.  Taking vectors as denoting points (the ends
of the vectors if all have the same origin), then the
projection of v onto u is the point on the line along u
that is closest to the point v.  That is, u.v is the
number K which minimizes | v - Ku |.  You can check this
with a little algebra.

A clockwise rotation R(theta) of a vector v=(vx,vy) by
an angle theta is

	         |   cos(theta)   sin(theta) | | vx |
    R(theta).v = |                           | |    |
	         | - sin(theta)   cos(theta) | | vy |

	      |   vx cos(theta) + vy sin(theta) |
	    = |                                 |
	      | - vx sin(theta) + vy cos(theta) |

Most particularly, if theta = 90 degrees, then

		
	                |  0   1 |
	R(90 degrees) = |        |
	                | -1   0 |


        R(90 degrees).v =  (vy,-vx)

These are all the basics you need to know.


Lines Dividing Planes
----- -------- ------

The line through points p and q, oriented in the
direction from p to q (p != q is assumed), divides the
plane into three parts: points to the right of the
line (facing in the direction from p to q), points to
the left of the line, and points on the line.  How do
we find out whether a point r is to the right, left,
or on the line?

Simply compute:

    v = R(90 degrees).(q-p) = (qy-py,-qx+px)

    Note: then v.q = v.p.

    if v.r > v.p then r is to the right of the line;
    if v.r < v.p then r is to the left of the line;
    if v.r = v.p then r is on the line.

v is the vector from p to q rotated 90 degrees clock-
wise, so it points to the right of the line from p to q.
Then
	 q - p                   v
	-------		and	---
	|q - p|                 |v|

are a pair of unit length vectors at right angles to
each other and form a coordinate system.  Therefore

	v.r
	---
	|v|

is the coordinate in this coordinate system in the
direction perpendicular to the line from p to q, and
this is > 0, = 0, or < 0 according to whether r is to
the right, on, or to the left of this line.

Note that if p, q, and r have integer coordinates, then
v.r and v.p are integers and are exact, and the clas-
sification of r as to the right, on, or to the left of
the line is exact, with no chance of roundoff error.

Sometimes the distance from r to the line from p to q
is desired.  This is just the absolute value of:

	v.r
	---
	|v|


Intersection
------------

Suppose we are given four points, p1, p2, q1, q2.
Question: Does the interior of the line from p1 to p2
intersect the interior of the line from q1 to q2.

Answer: It does iff the line from p1 to p2 splits q1 and
q2, and the line from q1 to q2 splits p1 and p2, where
for a line to split two points means that one point must
be to the right of the line and the other point must be
to the left of the line.  Note that necessarily p1 != p2
and q1 != q2, as otherwise at least one line would not
be defined.

Inside Polygons
------ --------

Suppose we have a polygon whose vertices are p1, p2,
..., pn in clockwise order.  Then a point r is inside
the polygon but not on the boundary of the polygon
iff r is to the right of each line from pj to pk where
k = (j mod n) + 1.

So when does a line from r1 to r2 intersect the inside
of the polygon.  It does if the interior of the line
from r1 to r2 intersects the interior of any line on the
boundary of the polygon.  But there are other cases,
where vertices of the polygon are on the line from r1
to r2.  If we list the vertices of the polygon that
are on the line from r1 to r2, in clockwise order, then
unless these vertices are consecutive in the p1, p2,
..., pn circular list, the line from r1 to r2 intersects
the interior of the polygon.

Polygon Maze
------- ----

Problem: Given a set of polygons in a plane, and two
points p and q outside any polygon, find the shortest
path from p to q that does not go inside any polygon.

Solution: Let V be the set of vertices of the polygons
plus the two points p and q.  Then the path to be found
can be represented as a sequence of straight line
segments with vertices in V (proof to reader).  So it
is a shortest path in an undirected graph whose vertices
are V such that given points r1 and r2 in V, there is
an edge in this undirected graph between r1 and r2 iff
the interior of the line from r1 to r2 does not inter-
sect the interior of the polygon.


Circular Anti-Maze
-------- ---------

Find the shortest path between two points in a plane
that has circular holes in it.  The part of a path
that transverses a hole does NOT count toward the
length of the path.


Convex Hull
------ ----

The convex hull of a set of points V in a plane is a
sequence of points p1, p2, p3, ..., pN such that for
every i, all the points of V are on or to the right
of the line from p(i) to p((i mod N) + 1).  To find
the convex hull, first find some point p1 on the hull,
which can be done say by choosing a leftmost point in V
and given two leftmost points choosing the highest.
Then extend the hull recursively from p(i) to p(i+1)
by using the following.

Given a point p, define a relation among points q1, q2
that are not equal to p as follows:

    definition:  q1 > q2 iff q2 is to the right of
			     the line from p to q1
			     or q2 is on this line and
			     closer to p that q1 is.

If p is on the hull, this relation is antisymmetric and
transitive (proof to reader).  So given the hull up to
p(i), choose p(i+1) to be the maximum point in V accord-
ing to this relation.  Stop when p(i+1) = p1, at which
point N=i.

This is not the fastest algorithm, as it has time
O(|V|**2) where |V| is the number of points in V.  The
fastest algorithm is the Gram-Schmidt algorithm that
begins with a sort of V and has running time dominated
by the sort time, O(|V| log|V|).
