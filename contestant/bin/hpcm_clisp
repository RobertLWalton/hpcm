#!/bin/sh
#
# Run the COMMONLISP interpreter.
#
# File:		hpcm_clisp
# Author:	Bob Walton <walton@deas.harvard.edu>
# Date:		Fri Jan 11 23:41:37 EST 2002
#
# The authors have placed this program in the public
# domain; they make no warranty and accept no liability
# for this program.
#
# RCS Info (may not be true date or author):
#
#   $Author: hc3 $
#   $Date: 2002/01/12 04:43:46 $
#   $RCSfile: hpcm_clisp,v $
#   $Revision: 1.2 $

d=`dirname $0`

# Process arguments.
#
case "$1" in
    -doc* )
        # Other argument.  Display documentation and
	# exit with an error.
	#
    	echo "
hpcm_clisp [input-file [output-file]]
hpcm_clisp -i load-file -x s-expression

    Execute COMMONLISP interpreter.  If input-file is
    given, it replaces terminal input, and if output-
    file is given, it replaces standard output.

    For this case see documentation obtainable from
    
    	\`(documentation 'run 'function)
    	\`(documentation 'vi 'function)
    	\`(documentation 'vil 'function)
    	\`(documentation 'vir 'function)
    	\`(documentation 'pico 'function)
    	\`(documentation 'picol 'function)
    	\`(documentation 'picor 'function)

    If instead the -i load-file and -x s-expression
    options are given, the load-file is loaded, and
    then the s-expression is evaluated, and there
    is no read-eval-print loop.
"
    	exit 1
	;;
    "")
	exec clisp -q -i $d/hpcm_clisp.lsp
	;;
    -i)
        exec clisp -q "$@"
	;;
    ?*)
    	case "$2" in
	    "")
		exec clisp -q -i $d/hpcm_clisp.lsp \
		           -x "(run :in \"$1\")"
	    	;;
	    *)
		run="(run :in \"$1\" :out \"$2\")"
		exec clisp -q -i $d/hpcm_clisp.lsp \
			   -x "$run"
	    	;;
	esac
	;;
esac
exit 0
