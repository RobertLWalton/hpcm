#! /bin/sh
#
# Print account names and passwords.
#
# File:		hpcm_print_passwords
# Author:	Bob Walton <walton@deas.harvard.edu>
# Date:		Sun Nov  5 11:11:25 EST 2000
#
# The authors have placed this program in the public
# domain; they make no warranty and accept no liability
# for this program.
#
# RCS Info (may not be true date or author):
#
#   $Author: hc3 $
#   $Date: 2000/11/06 01:31:12 $
#   $RCSfile: hpcm_print_passwords,v $
#   $Revision: 1.3 $

case "$1" in
    -* )
	    echo "
hpcm_print_passwords | lpr

    Account names and passwords taken from the file
    \`./passwords' are printed.  Each name and password
    is printed on a separate page, prefixed by the
    \`./passwords_header' file.  The hostname for the
    account is that returned by the \`hostname' program.
    Review the output before printing it by replacing
    \`lpr' by \`more' or \`less'."

	    exit 1
	    ;;
esac

if test ! -r passwords; then
    echo cannot read ./passwords
    echo "Usage: hpcm_print_passwords | lpr"
    exit 1
elif test ! -r passwords_header; then
    echo cannot read ./passwords_header
    echo "Usage: hpcm_print_passwords | lpr"
    exit 1
fi

hostname=`hostname`
for line in ` cat passwords `
do
    user=`echo $line | cut -d: -f1`
    password=`echo $line | cut -d: -f2`
    if test ! -d /home/$user; then
    	echo $user has no home directory
    else
	cat passwords_header
	echo ""
	echo "$user@$hostname      $password"
	echo -e '\f'
    fi
done

exit 0
