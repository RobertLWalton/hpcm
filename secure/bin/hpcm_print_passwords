#! /bin/sh
#
# Print account names and passwords.
#
# File:		hpcm_print_passwords
# Author:	Bob Walton <walton@deas.harvard.edu>
# Date:		Tue Sep 26 07:43:53 EDT 2000
#
# The authors have placed this program in the public
# domain; they make no warranty and accept no liability
# for this program.
#
# RCS Info (may not be true date or author):
#
#   $Author: hc3 $
#   $Date: 2000/09/26 11:45:10 $
#   $RCSfile: hpcm_print_passwords,v $
#   $Revision: 1.1 $

case "$1" in
    -* )
	    echo "hpcm_print_passwords | lpr"
	    echo "Account names and passwords" \
	         "are taken from \`./passwords'."
	    echo "The \`./passwords_header' file is" \
		 "output just before each password."
	    echo "The hostname is the output of the" \
		 "\`hostname' program."
	    echo "Each page contains all the above" \
		 "for one account/password pair."
	    echo "Review the output by replacing" \
		 "\`lpr' by \`more' or \`less'."
	    exit 1
	    ;;
esac

if test ! -r passwords; then
    echo cannot read ./passwords
    echo "Usage: hpcm_print_passwords"
    exit 1
elif test ! -r passwords_header; then
    echo cannot read ./passwords_header
    echo "Usage: hpcm_print_passwords"
    exit 1
fi

hostname=`hostname`
for line in ` cat passwords `
do
    user=`echo $line | cut -d: -f1`
    password=`echo $line | cut -d: -f2`
    if test ! -d /home/$user; then
    	echo $user has no home directory
    else
	cat passwords_header
	echo ""
	echo "$user@$hostname      $password"
	echo -e '\f'
    fi
done

exit 0
