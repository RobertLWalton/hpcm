#! /bin/sh
#
# Make User Accounts (to be executed by root)
#
# File:		hpcm_set_passwords
# Author:	Bob Walton <walton@deas.harvard.edu>
# Date:		Sun Sep 24 13:03:49 EDT 2000
#
# The authors have placed this program in the public
# domain; they make no warranty and accept no liability
# for this program.
#
# RCS Info (may not be true date or author):
#
#   $Author: hc3 $
#   $Date: 2000/09/24 18:07:39 $
#   $RCSfile: hpcm_set_passwords,v $
#   $Revision: 1.1 $

if test "$1" = ""; then
    echo "hpcm_set_passwords contest-directory-name"
    exit 1
fi

if test ! -r $1/secure/passwords; then
    echo cannot read $1/secure/passwords
    echo "Usage: hpcm_set_passwords" \
    	 "contest-directory-name"
    exit 1
fi

for line in ` cat $1/secure/passwords `
do
    user=`echo $line | cut -d: -f1`
    password=`echo $line | cut -d: -f2`
    if test ! -d /home/$user; then
    	echo $user has no home directory
    else
	echo passwd $user
	(sleep 2; echo $password; \
	 sleep 2; echo $password) \
		| passwd $user
    fi
done

exit 0
